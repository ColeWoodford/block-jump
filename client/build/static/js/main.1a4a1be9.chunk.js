(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{89:function(e,t,i){},90:function(e,t,i){"use strict";i.r(t);var n,o,r,s,a,c,h,d,l=i(44),m=i.n(l),v=i(18),u=i(6),b=i(2),f=i(7),y=i(0),p=i(1),w=i(4),j=i(45),g=function(){function e(t){Object(y.a)(this,e),this.game=void 0,this.controls=void 0,this.moveForward=void 0,this.moveBackward=void 0,this.moveLeft=void 0,this.moveRight=void 0,this.canJump=void 0,this.velocity=void 0,this.direction=void 0,this.prevJumpTime=void 0,this.animatePlayer=this.animatePlayer.bind(this),this.game=t,this.controls=new j.a(this.game.camera,this.game.mountRef.current),this.velocity=new w.o,this.direction=new w.o,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.canJump=!1}return Object(p.a)(e,[{key:"init",value:function(){var e=this;this.prevJumpTime=performance.now();var t=document.getElementById("blocker"),i=document.getElementById("instructions");null===i||void 0===i||i.addEventListener("click",(function(){e.controls.lock()})),this.controls.addEventListener("lock",(function(){i.style.display="none",t.style.display="none"})),this.controls.addEventListener("unlock",(function(){t.style.display="block",i.style.display=""})),this.game.scene.add(this.controls.getObject());document.addEventListener("keydown",(function(t){switch(t.code){case"ArrowUp":case"KeyW":e.moveForward=!0;break;case"ArrowLeft":case"KeyA":e.moveLeft=!0;break;case"ArrowDown":case"KeyS":e.moveBackward=!0;break;case"ArrowRight":case"KeyD":e.moveRight=!0;break;case"Space":var i=performance.now(),n=i-e.prevJumpTime;!0===e.canJump&&n>500&&(e.velocity.y+=350,e.prevJumpTime=i),e.canJump=!1}})),document.addEventListener("keyup",(function(t){switch(t.code){case"ArrowUp":case"KeyW":e.moveForward=!1;break;case"ArrowLeft":case"KeyA":e.moveLeft=!1;break;case"ArrowDown":case"KeyS":e.moveBackward=!1;break;case"ArrowRight":case"KeyD":e.moveRight=!1}}))}},{key:"animatePlayer",value:function(){var e=performance.now();if(!0===this.controls.isLocked){this.game.raycaster.ray.origin.copy(this.controls.getObject().position),this.game.raycaster.ray.origin.y-=10;var t=this.game.raycaster.intersectObjects(this.game.objects).length>0,i=(e-this.game.prevTime)/1e3;this.velocity.x-=10*this.velocity.x*i,this.velocity.z-=10*this.velocity.z*i,this.velocity.y-=9.8*100*i,this.direction.z=Number(this.moveForward)-Number(this.moveBackward),this.direction.x=Number(this.moveRight)-Number(this.moveLeft),this.direction.normalize(),(this.moveForward||this.moveBackward)&&(this.velocity.z-=400*this.direction.z*i),(this.moveLeft||this.moveRight)&&(this.velocity.x-=400*this.direction.x*i),!0===t&&(this.velocity.y=Math.max(0,this.velocity.y),this.canJump=!0),this.controls.moveRight(-this.velocity.x*i),this.controls.moveForward(-this.velocity.z*i),this.controls.getObject().position.y+=this.velocity.y*i,this.controls.getObject().position.y<10&&(this.velocity.y=0,this.controls.getObject().position.y=10,this.canJump=!0)}this.game.prevTime=e}}]),e}(),x=function(){function e(t){Object(y.a)(this,e),this.mountRef=void 0,this.player=void 0,this.scene=void 0,this.camera=void 0,this.renderer=void 0,this.raycaster=void 0,this.objects=void 0,this.prevTime=void 0,this.vertex=void 0,this.color=void 0,this.highScore=void 0,this.animate=this.animate.bind(this),this.mountRef=t,this.scene=new w.n,this.scene.background=new w.b(16777215),this.scene.fog=new w.f(16777215,0,750);var i=new w.g(15658751,7829384,.75);i.position.set(.5,1,.75),this.scene.add(i),this.vertex=new w.o,this.color=new w.b,this.highScore=0,this.camera=new w.k(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new w.p({antialias:!0}),this.objects=[],this.raycaster=new w.m(new w.o,new w.o(0,-1,0),0,10),this.player=new g(this),this.prevTime=performance.now()}return Object(p.a)(e,[{key:"init",value:function(){this.camera.position.y=10,this.player.init();var e=new w.l(2e3,2e3,100,100);e.rotateX(-Math.PI/2);for(var t=e.attributes,i=0,n=t.count;i<n;i++)this.vertex.fromBufferAttribute(t,i),this.vertex.x+=20*Math.random()-10,this.vertex.y+=2*Math.random(),this.vertex.z+=20*Math.random()-10,t.setXYZ(i,this.vertex.x,this.vertex.y,this.vertex.z);for(var o=[],r=0,s=(t=(e=e.toNonIndexed()).attributes.position).count;r<s;r++)this.color.setHSL(.3*Math.random()+.5,.75,.25*Math.random()+.75),o.push(this.color.r,this.color.g,this.color.b);e.setAttribute("color",new w.e(o,3));var a=new w.i({vertexColors:!0}),c=new w.h(e,a);this.scene.add(c);for(var h=new w.a(20,20,20).toNonIndexed(),d=[],l=0,m=(t=h.attributes.position).count;l<m;l++)this.color.setHSL(.3*Math.random()+.5,.75,.25*Math.random()+.75),d.push(this.color.r,this.color.g,this.color.b);h.setAttribute("color",new w.e(d,3));for(var v=0;v<700;v++){var u=new w.j({specular:16777215,flatShading:!0,vertexColors:!0});u.color.setHSL(.2*Math.random()+.5,.75,.25*Math.random()+.75);var b=new w.h(h,u);b.position.x=20*Math.floor(20*Math.random()-10),b.position.y=20*Math.floor(40*Math.random())+10,b.position.z=20*Math.floor(20*Math.random()-10),this.scene.add(b),this.objects.push(b)}this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.mountRef.current.appendChild(this.renderer.domElement)}},{key:"resize",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}},{key:"getHighScore",value:function(){return Math.ceil(this.highScore)}},{key:"animate",value:function(){requestAnimationFrame(this.animate),this.camera.position.y>this.highScore&&(this.highScore=this.camera.position.y),this.player.animatePlayer(),this.renderer.render(this.scene,this.camera)}}]),e}(),O=i(5),k=f.a.div(n||(n=Object(u.a)(["\n  position: absolute;\n  right: 1rem;\n  top: 1rem;\n  background-color: rgba(0, 0, 0, 0.5);\n  padding: 1rem;\n"]))),S=f.a.div(o||(o=Object(u.a)(["\n  color: #aaaaaa;\n"]))),z=f.a.div(r||(r=Object(u.a)(["\n  margin-bottom: 0.5rem;\n  font-size: 20px;\n  color: #aaaaaa;\n"]))),M=function(e){var t=e.scores;return Object(O.jsxs)(k,{children:[Object(O.jsx)(z,{children:"Leaderboard"}),t.map((function(e,t){return Object(O.jsxs)(S,{children:[e.senderName," --- ",e.body]},t)}))]})},L=i(27),R=i(49),A="http://localhost:5000",E=function(e){var t=Object(b.useState)([]),i=Object(v.a)(t,2),n=i[0],o=i[1],r=Object(b.useRef)();Object(b.useEffect)((function(){return console.log("here ",A),r.current=Object(R.io)(A,{query:{roomId:e}}),r.current.on("newHighScoresMessage",(function(e){var t=e.map((function(e){return Object(L.a)(Object(L.a)({},e),{},{ownedByCurrentUser:e.senderId===r.current.id})}));o(t)})),function(){r.current.disconnect()}}),[e]);return{scores:n,sendScore:function(e){r.current.emit("newScoreMessage",{body:e,senderId:r.current.id,senderName:"Cole"})}}},J=(i(89),f.a.div(s||(s=Object(u.a)(["\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n"])))),I=f.a.div(a||(a=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  overflow: hidden;\n"]))),B=f.a.h3(c||(c=Object(u.a)(["\n  position: absolute;\n  font-size: 35px;\n  color: #aaaaaa;\n  margin: 1rem;\n"]))),H=f.a.div(h||(h=Object(u.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n"]))),P=f.a.div(d||(d=Object(u.a)(["\n  width: 100%;\n  height: 100%;\n\n  display: -webkit-box;\n  display: -moz-box;\n  display: box;\n\n  -webkit-box-orient: horizontal;\n  -moz-box-orient: horizontal;\n  box-orient: horizontal;\n\n  -webkit-box-pack: center;\n  -moz-box-pack: center;\n  box-pack: center;\n\n  -webkit-box-align: center;\n  -moz-box-align: center;\n  box-align: center;\n\n  color: #ffffff;\n  text-align: center;\n  font-family: Arial;\n  font-size: 14px;\n  line-height: 24px;\n\n  cursor: pointer;\n"])));var C=function(){var e=Object(b.useRef)(null),t=Object(b.useRef)(0),i=Object(b.useState)(0),n=Object(v.a)(i,2),o=n[0],r=n[1],s=E(1),a=s.sendScore,c=s.scores;return Object(b.useEffect)((function(){var t=new x(e);t.init(),t.animate(),window.addEventListener("resize",(function(){t.resize()}),!1),setInterval((function(){return r(t.getHighScore())}),500)}),[]),Object(b.useEffect)((function(){o>t.current&&a(o),t.current=o}),[o,a]),Object(O.jsxs)(I,{children:[Object(O.jsxs)(B,{children:["HIGH SCORE: ",o]}),Object(O.jsx)(M,{scores:c}),Object(O.jsx)(H,{id:"blocker",children:Object(O.jsxs)(P,{id:"instructions",children:[Object(O.jsx)("span",{children:"CLICK TO PLAY"}),Object(O.jsx)("br",{}),Object(O.jsx)("br",{}),"Move: WASD",Object(O.jsx)("br",{}),"Jump: SPACE",Object(O.jsx)("br",{}),"Look: MOUSE",Object(O.jsx)("br",{})]})}),Object(O.jsx)(J,{ref:e})]})};m.a.render(Object(O.jsx)(C,{}),document.getElementById("root"))}},[[90,1,2]]]);
//# sourceMappingURL=main.1a4a1be9.chunk.js.map